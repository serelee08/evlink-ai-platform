<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.evlink.domain.mypage.dao.CommDao">
    <!-- 공통사항 조회 -->
    <select id="getUserComm" parameterType="int" resultType="mpuser">
        SELECT user_id, user_tp, login_id, user_nicknm, user_nm, user_phone
          FROM tb_user
         WHERE user_id = #{user_id} 
    </select>
    
    <!-- 공통사항 등록 -->
    <update id="setUserComm" parameterType="mpuser">
        UPDATE tb_user
        <set>
            <if test="user_nicknm != null">user_nicknm = #{user_nicknm},</if>
            <if test="user_nm != null">user_nm = #{user_nm},</if>
            <if test="user_phone != null">user_phone = #{user_phone},</if>
            upd_user = #{login_id},
            upd_dt = sysdate()
        </set>
         WHERE user_id = #{user_id}
    </update>
    
    <select id="callUserTpUpdate" statementType="CALLABLE" parameterType="mpuser">
        {call UPDATE_USER_TP(#{user_id, mode=IN, jdbcType=BIGINT})}
    </select>
</mapper>